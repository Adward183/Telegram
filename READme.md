<b>Описание проекта: </b>
Этот Telegram-бот предназначен для автоматической обработки и анализа образовательных данных из Excel-файлов. Бот генерирует различные типы отчетов для мониторинга учебного процесса.

<b>Основные возможности</b>

Бот поддерживает 6 типов отчетов:

Расписание - анализ учебного расписания

Темы уроков - проверка корректности оформления тем уроков

Оценки студентов - выявление студентов с проблемными оценками

Посещаемость преподавателей - мониторинг посещаемости преподавателей

ДЗ преподавателей - анализ проверки домашних заданий преподавателями

ДЗ студентов - мониторинг выполнения домашних заданий студентами

<b>Как использовать:</b>

Начните общение с ботом командой /start

Выберите тип отчета из меню

Загрузите Excel-файл с соответствующими данными

Получите текстовый отчет в виде файла

<b>Структура проекта:</b>
1. Основной модуль (main.py)
bot.polling(none_stop=True) - запуск бесконечного цикла получения обновлений от Telegram API

2. Модуль команд (handlers/commands.py)
Управление состояниями пользователей
user_states = {} - словарь для хранения текущего состояния пользователей (выбранный тип отчета)

Основные функции
show_main_menu(bot, chat_id, message_text=None)

Отображает главное меню с inline-кнопками

Параметры: bot - экземпляр бота, chat_id - ID чата, message_text - текст сообщения

Возвращает: объект отправленного сообщения

Обработчики команд
start(message) (декоратор @bot.message_handler(commands=['start']))

Обрабатывает команду /start

Приветствует пользователя и показывает главное меню

cancel_command(message) (декоратор @bot.message_handler(commands=['cancel']))

Обрабатывает команду /cancel

Сбрасывает состояние пользователя и показывает главное меню

handle_report_type(call) (декоратор @bot.callback_query_handler(func=lambda call: call.data.startswith('type_')))

Обрабатывает выбор типа отчета из inline-кнопок

Сохраняет выбранный тип в user_states

Удаляет предыдущее сообщение с меню

Запрашивает загрузку Excel-файла

3. Модуль документов (handlers/documents.py)
Основная функция обработки
handle_document(message) (декоратор @bot.message_handler(content_types=['document']))

Основная функция обработки загружаемых Excel-файлов

Шаги выполнения:

Проверяет наличие выбранного типа отчета у пользователя

Проверяет MIME-тип файла (допустимы .xls/.xlsx)

Скачивает файл на сервер

Вызывает обработчик Excel-файла

Отправляет результат пользователю

Очищает состояние пользователя

Удаляет временный файл

4. Модуль сообщений (handlers/messages.py)
Обработка текстовых сообщений
handle_messages(message) (декоратор @bot.message_handler(func=lambda message: True))

Обрабатывает все текстовые сообщения

Распознает команды: 'начать', 'start', '/start', 'id'

В остальных случаях показывает главное меню

5. Модуль обработки Excel (utils/excelProcessor.py)
Основная функция обработки
processExcelFileWithType(file_path, filename, file_type)

Главная функция обработки Excel-файлов

Параметры: file_path - путь к файлу, filename - имя файла, file_type - тип отчета

Возвращает: текстовый отчет

Функционал:

Проверяет размер файла (макс. 30 МБ)

Читает Excel-файл с поддержкой мультииндекса

Очищает названия столбцов

Вызывает соответствующий генератор отчета

6. Вспомогательные функции (utils/helpers.py)
Функции отправки отчетов
sendReport(bot, chat_id, text)

Основная функция отправки отчетов

Определяет имя файла и вызывает send_as_file

get_filename(text)

Определяет имя файла на основе содержания отчета

Использует префиксы отчетов для определения типа

send_as_file(bot, chat_id, text, filename)

Создает временный текстовый файл и отправляет его как документ

Автоматически удаляет временный файл после отправки

7. Модули генерации отчетов
Общие вспомогательные функции (используются в нескольких модулях)
find_column(df, possible_names) (в reportAttendanceTeachers.py, reportHomeworkStudents.py и др.)

Ищет столбец в DataFrame по списку возможных названий

Параметры: df - DataFrame, possible_names - список возможных названий столбцов

Возвращает: название найденного столбца или None

convert_to_percent(value) (в reportAttendanceTeachers.py)

Конвертирует значение в процентный формат

Обрабатывает числа, строки с символами %, дробные значения

get_percentage(value) (в reportHomeworkStudents.py)

Преобразует значение в процент (0-100)

Обрабатывает дробные значения (0.5 → 50%)

to_number(value) (в reportHomeworkTeachers.py, reportStudents.py)

Конвертирует значение в число

Возвращает 0 для нечисловых значений и NaN

Специфические функции генерации отчетов
attendanceTeachersReport(df) (reportAttendanceTeachers.py)

Анализирует посещаемость преподавателей

Выявляет преподавателей с посещаемостью ниже 40%

homeworkStudentsReport(df) (reportHomeworkStudents.py)

Анализирует выполнение ДЗ студентами

Выявляет студентов с выполнением ДЗ ниже 70%

homeworkTeachersReport(df) (reportHomeworkTeachers.py)

Анализирует проверку ДЗ преподавателями

Сравнивает показатели за неделю и месяц

scheduleReport(df) (reportSchedule.py)

Анализирует учебное расписание

Подсчитывает количество пар по каждому предмету

generateStudentsReport(df) (reportStudents.py)

Анализирует оценки студентов

Выявляет студентов с проблемными оценками (ДЗ=1 и КР<3)

topicsReport(df) (reportTopics.py)

Проверяет корректность оформления тем уроков

Использует регулярное выражение PatternTopic для проверки формата

8. Конфигурационные функции (config.py)
Создание директорий: os.makedirs(Temp, exist_ok=True)

Автоматически создает временную директорию при запуске